---
defaults: &defaults
  buildpack: python_buildpack
  instances: 1
  memory: 1G
  services:
    - notify-psql
    - notify-env
  env:
    RUNNER: './vcapenvwrapper --root notify-env'
    NOTIFY_ENVIRONMENT: production
    API_HOST_NAME: https://notify-api.apps.y.cld.gov.au
    ADMIN_BASE_URL: https://notify-admin.apps.y.cld.gov.au/
    ADMIN_CLIENT_SECRET: 817659DB3E1DAFB86819C53BC625FA3D7243CC7EE4B1D7BBC383FD4A52B25891
    DANGEROUS_SALT: 649F56460AE1EDC6466502A59452159D86DB26FCD59178EB3D19DDB4E3538032
    SECRET_KEY: A02D6B47E70EC2762426CD6BF8185765010A7FB487A30BEEDA75163780B6F9D9
    ROUTE_SECRET_KEY_1: F33F4A1E65BA4BD0EB320B86AC5206EFB87A4F95B9F00B91268FF52F797E5D13
    ROUTE_SECRET_KEY_2: A97D0099F2EB23E10CE9B1F1D9C53B1D88515942CAE272B61EA350F350E31383
    FLASK_APP: application.py
    SMTP_ADDR: smtp.hasmtp.cld.gov.au
    SMTP_USER: notifications@digital.gov.au
    TELSTRA_MESSAGING_CLIENT_ID: ''
    TELSTRA_MESSAGING_CLIENT_SECRET: ''
    IDENTITY_SMS_ADDR: https://sms-gateway.apps.y.cld.gov.au
    IDENTITY_SMS_USER: dto

applications:
- name: notify-api
  <<: *defaults
  command: make run-production
- name: notify-celery
  <<: *defaults
  health-check-type: process
  no-route: true
  command: make run-celery
